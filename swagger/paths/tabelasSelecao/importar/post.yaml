summary: Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel
description: |
  Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel.

  Caso o ficheiro seja CSV deve respeitar o seguinte:

  * Os delimitadores podem ser: ',' ou ';' ou '\t' ou '|'
  * O quote e o escape são realizados através de '\"'
  * O encoding do ficheiro tem de ser UTF-8

  O ficheiro (seja CSV ou Excel(xslx)) tem de:

  * Possuir uma sheet em que na 1º coluna tenha como header 'Código' e por baixo os códigos dos processos
  * Na mesma linha da header 'Código' possuir:
    * No máximo uma coluna 'Título'
    * Pelo menos uma coluna começada por 'Dono' ou 'Participante', no máximo uma de cada (TS Organizacional)
    * Pelo menos uma coluna do tipo 'Entidade Dono' ou 'Entidade Participante', no máximo uma de cada para cada entidade (TS Pluriorganizacional)
  * Por baixo de cada coluna (exceto a coluna 'Título' e 'Código') deve estar:
      * x ou X os processos selecionados
      * Nada para os processos não selecionados
security:
  - userQuery: []
  - userAuth: []
tags:
  - Tabelas de Seleção
requestBody:
  description: 'FormData com o ficheiro (file), o tipo de TS a criar (tipo_ts) e, caso o tipo de TS seja "TS Organizacional", a sigla da entidade da TS (entidade_ts)'
  required: true
  content:
    multipart/form-data:
      schema:
        type: object
        properties:
          file:
            type: string
            format: binary
          tipo_ts:
            type: string
            enum: ['TS Organizacional', 'TS Pluriorganizacional']
          entidade_ts:
            $ref: '#/components/schemas/EntidadeId'
responses:
  200:
    description: Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel
    content:
      application/json:
        schema:
          oneOf:
            - $ref: '#/components/schemas/TabelaSelecaoImportarOrg'
            - $ref: '#/components/schemas/TabelaSelecaoImportarPluri'
        examples:
          Exemplo da importação de uma TS Organizacional:
            $ref: '#/components/examples/TabelaSelecaoImportarOrg'
          Exemplo da importação de uma TS Pluriorganizacional:
            $ref: '#/components/examples/TabelaSelecaoImportarPluri'
  401:
    $ref: '#/components/responses/UnauthorizedUser'
  403:
    $ref: '#/components/responses/PermissionsUser'
  500:
    description: Erro
