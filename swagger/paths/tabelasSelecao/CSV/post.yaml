summary: Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel
description: |
  Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel.

  Caso o ficheiro seja CSV deve respeitar o seguinte:

  * Os delimitadores podem ser: ',' ou ';' ou '\t' ou '|'
  * O quote e o escape são realizados através de '\"'
  * O encoding do ficheiro tem de ser UTF-8

  O ficheiro (seja CSV ou Excel(xslx)) tem de:

  * Possuir uma sheet em que na 1º coluna tenha como header 'Código' e por baixo os códigos dos processos
  * Na mesma linha da header 'Código' possuir:
    * Possuir no máximo uma coluna 'Título'
    * Pelo menos uma coluna começada por 'Dono' ou 'Participante', no máximo uma de cada (TS Organizacional)
    * Pelo menos uma coluna do tipo 'Entidade Dono' ou 'Entidade Participante', no máximo uma de cada para cada entidade (TS Pluriorganizacional)
    * Por baixo de cada coluna deve estar:
      * x ou X os processos selecionados
      * Nada para os processos não selecionados
tags:
  - tabelasSelecao
requestBody:
  description: 'FormData com o ficheiro (file), o email (email), a sigla da entidade do utilizador que criou o pedido (entidade_user), o tipo de TS a criar (tipo_ts) e, caso o tipo de TS seja "TS Organizacional", a sigla da entidade da TS (entidade_ts)'
  required: true
  content:
    multipart/form-data:
      schema:
        type: object
        properties:
          file:
            type: string
            format: binary
          email:
            type: string
            format: email
          entidade_user:
            type: string
          tipo_ts:
            type: string
            enum: ['TS Organizacional', 'TS Pluriorganizacional']
          entidade_ts:
            type: string
responses:
  200:
    description: Cria um pedido de criação de uma tabela de seleção a partir de um ficheiro CSV/Excel
  500:
    description: Erro
