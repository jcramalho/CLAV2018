extends ../layout
block corpo
    #organizacao-form.panel.panel-default.panel-custom
        .panel-heading
            h1.page-header {{ myEntidade.designacao }}
        .panel-body
            .form-group
                table.consulta(style="border-color: white; border-style:solid; margin-bottom:20px")
                    //- NOME
                    tr 
                        td(style="width:10%")
                            .info-label Nome:
                        td(v-if="editDes" style="width:80%")
                            input(
                                size="50"
                                v-model="newDes"
                                :placeholder="myEntidade.designacao"
                                maxlength="50"
                            )
                        td(v-else style="width:80%")
                            | {{ myEntidade.designacao }}
                        if user 
                            td(style="width:10%")
                                label(
                                    for="editDes"
                                    :class="[editDes ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']" 
                                )  
                                input(
                                    id="editDes"
                                    type="checkbox"
                                    v-model="editDes"
                                    class="drop-row"
                                )

                    //- Sigla
                    tr
                        td
                            .info-label Sigla: 
                        td(v-if="editSigla" style="width:80%")
                            input(
                                size="50"
                                v-model="newSigla"
                                :placeholder="myEntidade.sigla"
                                maxlength="10"
                            )  
                        td(v-else style="width:80%")
                            | {{ myEntidade.sigla }} 

                        if user
                            td(style="width:10%")
                                label(
                                    for="editSigla"
                                    :class="[editSigla ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']" 
                                ) 
                                input(
                                    id="editSigla"
                                    type="checkbox"
                                    v-model="editSigla"
                                    class="drop-row"
                                )
                            

                    //- Estado
                    tr
                        td
                            .info-label Estado:
                        td(v-if="editEstado" style="width:80%")
                            input(
                                size="50"
                                v-model="newEstado"
                                :placeholder= "myEntidade.estado"
                            ) 
                        td(v-else style="width:80%")
                            | {{ myEntidade.estado }}

                        if user
                            td(style="width:10%")
                                label(
                                    for="editEstado"
                                    :class="[editEstado ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']" 
                                ) 
                                input(
                                    id="editEstado"
                                    type="checkbox"
                                    v-model="editEstado"
                                    class="drop-row"
                                )

                    //- Internacional
                    tr
                        td(style="width:10%")
                            .info-label Internacional:
                        td(v-if="editInternacional" style="width:80%")
                            select(
                                v-model="newInternacional"
                            )
                                option(
                                    value="Sim" 
                                )   Sim
                                option(
                                    selected
                                    value="Não"
                                )   Não
                        td(v-else style="width:80%")
                            | {{ myEntidade.internacional }}
                        if user
                            td(style="width:10%")
                                label(
                                    for="editInternacional"
                                    :class="[editInternacional ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']" 
                                )
                                input(
                                    id="editInternacional"
                                    type="checkbox"
                                    v-model="editInternacional"
                                    class="drop-row"
                                )

                    //-SIOE
                    tr
                        td(style="width:10%")
                            .info-label SIOE: 
                        td(v-if="editSIOE" style="width:80%")
                            input(
                                    size="50"
                                    v-model="newSIOE"
                                    :placeholder= "myEntidade.sioe"
                                    maxlength="12"
                                ) 
                            td(v-else style="width:80%")
                                | {{ myEntidade.sioe }}

                        if user
                            td(style="width:10%")
                                label(
                                    for="editSIOE"
                                    :class="[editSIOE ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']" 
                                ) 
                                input(
                                    id="editSIOE"
                                    type="checkbox"
                                    v-model="editSIOE"
                                    class="drop-row"
                                )

                    //- Tipologias
                    tr
                        td(style="width:10%")
                            .info-label Pertence às tipologias de Entidade:
                        td(v-if="editTipologia" style="width:80%")
                                table
                                    tr
                                        td(width="1000px")
                                            v-select.custom-select( 
                                                v-model="newTipologia"
                                                :options="tipoListaCompleta"
                                            )
                                        td
                                            input(
                                                type="button"
                                                @click="addTipo"
                                                value="+"
                                            )
                                    tr(v-if="newListaTipologias.length")
                                        td
                                            ul(style="padding-left:20px")
                                                li(v-for="(o,index) in newListaTipologias")
                                                    | {{ o.sigla }} - {{ o.designacao }}
                                                    button(
                                                        @click="newListaTipologias.splice(index,1)"
                                                    ) x
                        td(v-else style="width:80%")
                            ul(style="padding-left:20px")
                                li(v-for="o in listaTipologias")
                                    a(:href="'/tipologias/'+o.id") {{ o.sigla }} 
                                    | - {{ o.designacao }}
                        if user
                            td(style="width:10%")
                                    label(
                                        for="editTipologia"
                                        :class="[editTipologia ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']"
                                    )
                                    input(
                                        id="editTipologia"
                                        type="checkbox"
                                        v-model="editTipologia"
                                        class="drop-row"
                                    )
                    //- Intervenção nos PN
                    tr
                        td(style="width:10%")
                            .info-label Natureza de intervenção nos Processos de Negócio:
                        td(v-if="editDono" style="width:80%")
                            table
                                .col-sm
                                    label Como Dono:
                                .col-sm
                                tr
                                    td(width="1000px")
                                        v-select.custom-select(
                                            v-model="novaClasse"
                                            :options="listaClasses"
                                        )
                                    td
                                        input(
                                                type="button"
                                                @click="addDono"
                                                value="+"
                                            )
                                tr(v-if="novoDono.length")
                                    td
                                        ul(style="padding-left:20px")
                                            li(v-for="(c,index) in novoDono")
                                                | {{ c.codigo }} - {{ c.titulo }}
                                                button(
                                                    @click= "novoDono.splice(index,1)"
                                                ) x
                        td(v-else style="width:10%")
                            .col-sm
                                label Como Dono:
                            .col-sm
                                ul(v-if="eDonoProcessos" style="padding-left:50px" :class="{'is-collapsed' : domainCollapsed }")
                                    li(v-for="p in donoProcessos")
                                        a(:href="'/classes/c'+ p.codigo") {{ p.codigo }}
                                        | - {{ p.titulo }}
                                a(@click="domainCollapsed=!domainCollapsed" v-if="donoProcessos.length>6").maozinha
                                    span(v-if="domainCollapsed") Mostrar mais...
                                    span(v-else) Mostrar menos...
                        if user
                            td(style="width:10%")
                                label(
                                    for="editDono"
                                    :class="[editDono ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']"
                                )
                                input(
                                    id="editDono"
                                    type="checkbox"
                                    v-model="editDono"
                                    class="drop-row"
                                )

                            //- PARTICIPAÇÕES
                        tr
                            td(style="width:10%")
                                label Como Participante:
                            //- edição
                            td(v-if="editParts" style="width:80%")
                                table
                                    tr
                                        td(width="300px")
                                            v-select.custom-select(
                                                v-model="novoTipoPart"
                                                :options="partOptions"
                                            )
                                        td(width="700px")
                                            v-select.custom-select(
                                                v-model="novaPart"
                                                :options="listaClasses"
                                            )
                                        td
                                            input(
                                                type="button"
                                                @click="addPart"
                                                value="+"
                                            )
                                    tr
                                        td(colspan="3")
                                            ul(v-if="partsReady" style="padding-left:20px")
                                                li(v-for="key in Object.keys(newParticipations)" v-if="newParticipations[key].length")
                                                    b {{ participacoesDic[key] }}:
                                                    ul
                                                        li(v-for="(c, index) in newParticipations[key]")
                                                            | {{ c.label }}
                                                            button(
                                                                @click="newParticipations[key].splice(index,1)"
                                                            ) x
                            td(v-else style="width:80%")
                                ul(v-if="partsReady" style="padding-left:20px")
                                    li(v-for="key in Object.keys(participacoes)" v-if="participacoes[key].length>0")
                                        b  {{ participacoesDic[key] }}:
                                        ul(:class="{'is-collapsed' : partsCollapsed[key] }")
                                            li(v-for="p in participacoes[key]")
                                                a(:href="'/classes/c'+p.codigo") {{ p.codigo }}
                                                |  - {{ p.titulo }}
                                        a(@click="partsCollapsed[key]=!partsCollapsed[key]" v-if="participacoes[key].length>6").maozinha
                                            span(v-if="partsCollapsed[key]") Mostrar mais...
                                            span(v-else) Mostrar menos...
                            if user
                                td(style="width:10%")
                                    label(
                                        for="editParts"
                                        :class="[editParts ? 'glyphicon glyphicon-remove' : 'glyphicon glyphicon-edit']"
                                    )
                                    input(
                                        id="editParts"
                                        type="checkbox"
                                        v-model="editParts"
                                        class="drop-row"
                                    )
                                
                            
                
            spinner(ref="spinner" fixed size="lg" text="Por favor aguarde...")

            if user
                input.btn.btn-xs.btn-default.col-sm-1(
                    type="button" 
                    @click="update" 
                    value="Submeter alteração" 
                    :disabled="!(editDes || editEstado || editSigla || editSIOE || editInternacional || editDono || editParts || editTipologia)"  
                )
                input.btn.btn-xs.btn-warning.col-sm-1(
                    type="button" 
                    @click="delConfirm=true" 
                    value="Apagar" 
                    :disabled="(editDes || editEstado || editSigla || editInternacional || editSIOE || editDono || editParts || editTipologia)"
                )
                p.col-sm-5 

                modal(
                    title="Confirmar" 
                    :value="delConfirm"
                    @closed="delConfirm=false"

                    small
                ) 
                    .modal-body(slot="modal-body")
                        center Tem a certeza que deseja apagar?
                    .modal-footer(slot="modal-footer")
                        button(@click="deleteEntidade" style="margin-right:7px") Ok
                        button(@click="delConfirm=false") Cancelar

append scripts    
    script(src="/javascripts/entidades/edicao.vue")