extends ../layout
block corpo
    #nova-legislacao-form.panel.panel-default.panel-custom
        .panel-heading
            h1.page-header Novo Diploma
        .panel-body
            .form-group
                table.consulta(style="border-color: white; border-style:solid; margin-bottom:20px")
                    
                    //- Sumário
                    tr
                        td(style="width: 10%")
                            .info-label Sumario: 
                        td(style="width:80%")
                            input(
                                size="150"
                                v-model="diploma.sumario"
                            )
                    
                    //- Tipo
                    tr
                        td(style="width: 10%")
                            .info-label Tipo: 
                        td(style="width:80%")
                            select(v-model="diploma.tipo")
                               option(v-for="t in tipoDiploma" :value="t.termo") {{ t.termo }}
                          
                    
                    //- Número
                    tr
                        td(style="width: 10%")
                            .info-label Número: 
                        td(style="width:80%")
                            input(
                                size="50"
                                v-model="diploma.numero"
                                pattern="[0-9]+(\-\w)?/[0-9]+"
                                placeholder=" NNNNNN/AAAA"
                                maxlength="11"
                            )

                    //- Entidades
                    tr(style="padding-bottom:30px")
                        td(style="width: 10%")
                            .info-label Entidades:

                        td
                            accordion
                                panel(type="white" header="Selecionar Entidades")
                                    custom-table-select(
                                        v-if="orgsReady"

                                        :header="orgsTableHeader"
                                        :complete-rows="orgs"
                                        :ready="orgsReady"
                                        :cwidth="orgsTableWidth"
                                        
                                        class-table='table table-condensed'

                                        @select-clicked="orgSelected($event,diploma.entidades)"
                                    )
                                    h4(
                                        v-else
                                    ) A carregar...
                    //- Data
                    tr
                        td(style="width: 10%")
                            .info-label Data: 
                        td(style="width:80%")
                            datepicker(
                                value=""
                                @input="dataEscolhida($event)"
                                format="yyyy/MM/dd"
                                placeholder="AAAA/MM/DD"
                            )
       
                    //- Link
                    tr
                        td(style="width: 10%")
                            .info-label Link: 
                        td(style="width:80%")
                            input(
                                size="50"
                                v-model="diploma.link"
                            )

                    //- PROCESSOS
                    tr
                        td(style="width:10%")
                            .info-label Processos Regulamentados:
                        td(style="width:80%")
                            table
                                tr
                                    td(width="1000px")
                                        v-select.custom-select(
                                            v-model="newProcesso"
                                            :options="listaClasses"
                                        )
                                    td
                                        input(
                                            type="button"
                                            @click="addProcesso"
                                            value="+"
                                        ) 
                                tr(v-if="processos.length")
                                    td
                                        ul(style="padding-left:20px")
                                            li(v-for="(c,index) in processos")
                                                | {{ c.codigo }} - {{ c.titulo }}  
                                                button(
                                                    @click="processos.splice(index,1)"
                                                ) x

            spinner(ref="spinner" size="lg" fixed text="Por favor aguarde...")

            input.btn.btn-xs.btn-default.col-sm-2(
                type="button" 
                @click="add" 
                value="Submeter nova Legislação" 
                :disabled="!readyToCreate()"

                style="margin-right:10px"
            )
            div(v-html="message")

    //-
    

append scripts    
    script(src="/javascripts/leg/adicao.vue")